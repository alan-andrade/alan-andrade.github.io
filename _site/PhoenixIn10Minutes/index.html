<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Phoenix in 10 minutes &#8211; Alan Andrade</title>

<meta name="keywords" content="">



<!-- Twitter Cards -->
<meta name="twitter:title" content="Phoenix in 10 minutes">

<meta name="twitter:site" content="@_alan_andrade">
<meta name="twitter:creator" content="@_alan_andrade">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://alan-andrade.github.io/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Phoenix in 10 minutes">

<meta property="og:url" content="http://alan-andrade.github.io/PhoenixIn10Minutes/">
<meta property="og:site_name" content="Alan Andrade">

<meta property="og:image" content="http://alan-andrade.github.io/images/default-thumb.png">






<link rel="canonical" href="http://alan-andrade.github.io/PhoenixIn10Minutes/">
<link href="http://alan-andrade.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Alan Andrade Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://alan-andrade.github.io/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="http://alan-andrade.github.io/assets/js/vendor/html5shiv.min.js"></script>
	<script src="http://alan-andrade.github.io/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://alan-andrade.github.io/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://alan-andrade.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://alan-andrade.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://alan-andrade.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://alan-andrade.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://alan-andrade.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://alan-andrade.github.io/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="http://alan-andrade.github.io/">Alan Andrade</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="http://alan-andrade.github.io/about/" >About</a></li>
				
				    
				        
				    
				    <li><a href="http://alan-andrade.github.io/posts/" >Sample Posts</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    


<div itemscope itemtype="http://schema.org/Person">


	<img src="http://alan-andrade.github.io/images/bio-photo.jpg" class="bio-photo" alt="Alan Andrade bio photo">


  <h3 itemprop="name">Alan Andrade</h3>
  <p>I was born in Mexico and I'm currently living in they bay area. I love the ferry commute in the mornings and I like to make music. My favorite spot is the dock.</p>
  <a href="mailto:alan.andradec+website@gmail.com" class="author-social" target="_blank"><i class="fa fa-fw fa-envelope-square"></i> Email</a>
  <a href="http://twitter.com/_alan_andrade" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a>
  
  
  <a href="http://linkedin.com/in/alanandradec" class="author-social" target="_blank"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a>
  
  
  
  <a href="http://github.com/alan-andrade" class="author-social" target="_blank"><i class="fa fa-fw fa-github"></i> Github</a>
  
  
  
  
  
  
  
  <a href="http://soundcloud.com/alanandrade123" class="author-social" target="_blank"><i class="fa fa-fw fa-soundcloud"></i> Soundcloud</a>
  
  
  
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="http://alan-andrade.github.io/PhoenixIn10Minutes/" rel="bookmark" title="Phoenix in 10 minutes">Phoenix in 10 minutes</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>So you’ve been hearing good stuff about Elixir and Phoenix but you
haven’t had a chance to check it out ? Well, you’re reading the right blog
post. Today we’re going to build an API that will echo the parameters of the
request with json format. Within 10 minutes. So don’t go to lunch yet,
check this out.</p>

<h1 id="resources">Resources</h1>

<h2 id="erlang">Erlang</h2>

<p>In order to use Elixir, we need to install Erlang first because Elixir
runs on top of Erlang’s virtual machine. Install Erlang 18.0 from
<a href="https://www.erlang-solutions.com/downloads/download-erlang-otp">here</a></p>

<h2 id="elixir">Elixir</h2>

<p>Brew it with <code>brew update &amp;&amp; brew install elixir</code> or install it from <a href="http://elixir-lang.org/install.html#distributions">here</a></p>

<h2 id="phoenix">Phoenix</h2>

<ol>
  <li>Install ‘hex’, the dependency manager <code>mix local.hex</code></li>
  <li>Install Phoenix <code>mix archive.install
https://github.com/phoenixframework/phoenix/releases/download/v1.0.3/phoenix_new-1.0.3.ez</code></li>
</ol>

<p>Elixir comes with a tool called mix which is like ruby’s rake, it runs
predefined tasks or “recipes”.  Hex on the other hand, ensures that
every library that we use is compatible with each other. Hex plays the
role of Bundler or NPM, but for Elixir.</p>

<h1 id="project-creation">Project creation</h1>

<p><code>mix phoenix.new echoAPI --no-brunch --no-ecto --no-html</code></p>

<ol>
  <li>Create the project under the folder “echoAPI”.</li>
  <li><code>--no-brunch</code> Skips the asset manager for front end stuff such as images
and javascripts.</li>
  <li><code>--no-ecto</code> Skips the database and the model layer.</li>
  <li><code>--no-html</code> Skips the generation of any html.</li>
</ol>

<h1 id="the-plan">The plan</h1>

<p>Phoenix follows the MVC pattern and comes with conventions
similar to those present in rails or ember. Don’t worry if you haven’t
used any of those frameworks, I’ll explain the general idea and you’ll
be able to follow along.</p>

<p>To build our useful echo endpoint, we’re going to work on two key components.
Remember that this app doesn’t need any database so the “Model” is out
of the “MVC”<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup>. We need to define a <strong>controller</strong> that can handle the high
volume of incoming requests and also get it to render json.
We’ve tackled the 3 letters out of MVC, but to get this to work, we need
to define a new entry on the application’s <strong>router</strong>. The routes are
like a map that hold information of which controller will process what
endpoint. e.g. <code>/api/echo</code> should be handled by the controller
“EchoController”.</p>

<p>Let’s begin !</p>

<h1 id="controller">Controller</h1>

<p>Create a new file under <code>web/controllers</code> and name it
<code>echo_controller.ex</code>.</p>

<p>The controller will process the request and should return a json with
all the parameters sent in the request. The file should look like this.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">EchoAPI.EchoController</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="nc">EchoAPI.Web</span> <span class="ss">:controller</span>

  <span class="kd">def</span> <span class="n">index</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="n">json</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<ol>
  <li><code>defmodule</code> Is used to define a new module in Elixir.</li>
  <li><code>EchoAPI.EchoController</code> is the name of the controller prefixed by
the namespace of the application.</li>
  <li><code>use EchoApi.Web :controller</code> is where something like inheritance
happens. This will inject code that comes from `web/web.ex’ which
  gives this module the interface and features of a controller.</li>
  <li><code>def index(conn, params)</code> is a function definition which will called
when the request comes in.</li>
  <li><code>conn</code> is the current connection.</li>
  <li><code>params</code> are the request parameters.</li>
  <li><code>json</code> Is a method defined in <code>Phoenix.Controller</code> which sends a json
reponse with the second argument as the body.</li>
</ol>

<p>This controller is ready to answer requests and echo the parameters
back. Let’s connect it it the router.</p>

<h1 id="routes">Routes</h1>

<p>Open <code>web/router.ex</code>, it should look like this.</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="kd">defmodule</span> <span class="nc">EchoAPI.Router</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="nc">EchoAPI.Web</span><span class="p">,</span> <span class="ss">:router</span>

  <span class="n">pipeline</span> <span class="ss">:api</span> <span class="k">do</span>
    <span class="n">plug</span> <span class="ss">:accepts</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;json&quot;</span><span class="p">]</span>
  <span class="k">end</span>

  <span class="n">scope</span> <span class="s2">&quot;/api&quot;</span><span class="p">,</span> <span class="nc">EchoAPI</span> <span class="k">do</span>
    <span class="n">pipe_through</span> <span class="ss">:api</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre></div>

<ul>
  <li><code>pipeline</code> is a wrapper for a set of operations that will be made on
the request. Similar concept to Rack.</li>
  <li>a <code>plug</code> is an interface for operations that will run inside of a
pipeline. This is like the Rack Middleware.</li>
  <li><code>scope</code> is used to group endpoints and the second argument is an
alias. This means that anywhare under scope, you can use your modules
without typing the namespace. e.g. “EchoAPI.EchoController” becomes
“EchoController”.</li>
  <li><code>pipe_through</code> is making sure that anything under that group, goes
through the the set of operations of the pipeline “api”.</li>
</ul>

<p>Let’s connect out new controller !</p>

<div class="highlight"><pre><code class="language-elixir" data-lang="elixir"><span class="c1"># ...</span>
<span class="n">scope</span> <span class="s2">&quot;/api&quot;</span><span class="p">,</span> <span class="nc">EchoAPI</span> <span class="k">do</span>
  <span class="n">pipe_through</span> <span class="ss">:api</span>

  <span class="n">get</span> <span class="s1">&#39;/echo&#39;</span><span class="p">,</span> <span class="nc">EchoController</span><span class="p">,</span> <span class="ss">:index</span>
<span class="k">end</span>
<span class="c1"># ...</span></code></pre></div>

<ul>
  <li><code>get</code> is a macro that maps the controller to a <code>GET</code> request.</li>
  <li><code>/echo</code> is the endpoint and since its under the “/api” scope, its
final shape is “/api/echo”</li>
  <li><code>EchoController</code> is the name of the controller that will serve.</li>
  <li><code>:index</code> is the function of the controller that will take care of
things.</li>
</ul>

<h1 id="play">Play</h1>

<ol>
  <li>Run you application with <code>mix phoenix.server</code></li>
  <li>Use curl or a browser to point to the new endpoint. <code>curl
localhost:4000/api/echo\?foo=bar</code></li>
  <li>Feel proud. <img class="emoji" title="godmode" alt="godmode" src="https://github.global.ssl.fastly.net/images/icons/emoji/godmode.png" height="20" width="20" align="absmiddle" /></li>
</ol>

<h1 id="conclusion">Conclusion</h1>

<p>If you come from the Rails world, Phoenix will look quite familiar.</p>

<p>Most of the framework’s ideas can be traced back to Rails and friends.
This helps to understand more about how things work and connect the
dots.</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>Not having a database doesn’t mean our app doesn’t have a model.  I made an exception and tight the two concepts together. It’s perfectly normal to have “Models” that aren’t dependant on a database. <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=http://alan-andrade.github.io/PhoenixIn10Minutes/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=http://alan-andrade.github.io/PhoenixIn10Minutes/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=http://alan-andrade.github.io/PhoenixIn10Minutes/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>Phoenix in 10 minutes</strong> was published on <time datetime="2015-10-10T22:43:25-07:00">October 10, 2015</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  
  <footer>
    

<span>&copy; 2015 Alan Andrade. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://alan-andrade.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://alan-andrade.github.io/assets/js/scripts.min.js"></script>




</body>
</html>
